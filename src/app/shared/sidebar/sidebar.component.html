<div class="relative h-screen bg-[var(--green-darker)] text-[var(--gray-light)] rounded-2xl m-1 flex flex-col
         transition-[width] duration-500 ease-in-out  p-2 flex-shrink-0" [ngClass]="collapsed ? 'w-20' : 'w-80'">


  <!-- Header -->
  <button (click)="toggleSidebar()" class="absolute top-1/2  -left-6 transform -translate-y-1/2
         flex items-center justify-center w-15 h-15 rounded-full
         bg-[var(--gold-primary)] text-white shadow-lg
         hover:scale-105 active:scale-95 transition-all duration-300 cursor-pointer">

    <!-- Arrow -->
    <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 transition-transform duration-700"
      [ngClass]="collapsed ? 'rotate-180' : 'rotate-0'" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
    </svg>

  </button>

  <div class="flex items-center justify-between p-4 border-b border-[var(--green-dark)]">
<h2 *ngIf="!collapsed" class="text-2xl font-bold text-[var(--gold-primary)] font-serif">
  أكـــــــــاديـميـــة قـــبــــس
</h2>
    <!-- Sidebar Toggle Button -->
    <!-- Sidebar Toggle Button (Arrow on middle edge) -->



  </div>

  <!-- Items -->
  <ul class="flex-1 mt-6 space-y-5 ">
    <li *ngFor="let item of items" class="  cursor-pointer ">

      <!-- Parent Link -->
      <div (click)="toggleItem(item)"
        class="flex items-center  justify-between hover:bg-[var(--gold-primary)]  rounded-md  ">
       <a [routerLink]="item.route || null" routerLinkActive="active-link" [routerLinkActiveOptions]="{ exact: true }"
          class="flex items-center gap-5 flex-1 rounded-md transition-all duration-300 p-2"
          [ngClass]="{ 'justify-center': collapsed, 'justify-start': !collapsed }">

          <span *ngIf="item.icon" [innerHTML]="getIcon(item.icon)"></span>

          <span *ngIf="!collapsed" class="transition-all duration-500 delay-300 text-xl overflow-hidden"
            [ngClass]="{ 'opacity-0': collapsed, 'opacity-100': !collapsed }">
            {{ item.label }}
          </span>

        </a>




        <!-- Caret if has children -->
        <span *ngIf="item.children && !collapsed" class="ml-2">
          <svg class="w-3 h-3 transition-transform duration-400" [class.rotate-180]="item.open" aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 10 6">
            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="m1 1 4 4 4-4" />
          </svg>
        </span>


      </div>

      <!-- Children (Dropdown) -->
      <ul *ngIf="item.children && item.open && !collapsed" class="ml-6 mt-1 pr-8 text-lg space-y-2">
        <li *ngFor="let child of item.children" class="   border-b border-[var(--gray-dark)]">
          <a [routerLink]="child.route" class="flex items-center gap-3 text-[var(--gold-primary)] hover:bg-[var(--green-secondary)]  rounded-md p-2 "
            routerLinkActive="active-link" [routerLinkActiveOptions]="{ exact: true }">
            <!-- <span class="text-[var(--gold-secondary)]">•</span> -->
            {{ child.label }}
          </a>
        </li>
      </ul>
    </li>
  </ul>



  <!-- Footer -->
  <div
    class="relative cursor-pointer p-4 border-t border-[var(--green-dark)]/30 bg-gradient-to-r from-[var(--green-secondary)] to-[var(--green-primary)]"
    (click)="toggleUserMenu()">

    <!-- Expanded (not collapsed) -->
    <div *ngIf="!collapsed" class="flex items-center gap-3">
      <div class="w-8 h-8 bg-[var(--gold-primary)] rounded-full flex items-center justify-center">
        <svg class="w-4 h-4 text-[var(--green-darker)]" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd" />
        </svg>
      </div>
      <div class="flex flex-col">
        <span class="text-sm font-medium text-[var(--gold-primary)]">User Name</span>
        <span class="text-xs text-[var(--gray-medium)]">Online</span>
      </div>
    </div>

    <!-- Collapsed -->
    <div *ngIf="collapsed" class="flex justify-center">
      <div class="w-8 h-8 bg-[var(--gold-primary)] rounded-full flex items-center justify-center">
        <svg class="w-4 h-4 text-[var(--green-darker)]" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd" />
        </svg>
      </div>
    </div>

    <!-- Dropdown Menu -->
    <div *ngIf="userMenuOpen"
      class="absolute bottom-16 left-0 w-full bg-[var(--green-darker)] text-[var(--gray-light)] rounded-md shadow-lg overflow-hidden animate-fadeIn">
      <ul class="flex flex-col ">

        <!-- Profile -->
        <li>
          <a routerLink="/profile"
            class="flex items-center gap-2 px-4 py-2 hover:bg-[var(--gold-primary)] cursor-pointer rounded-md"
            [ngClass]="{ 'justify-center': collapsed, 'justify-start': !collapsed }">
            <i class="fas fa-user"></i>
            <span *ngIf="!collapsed">Profile</span>
          </a>
        </li>

        <!-- Settings -->
        <li>
          <a routerLink="/settings"
            class="flex items-center gap-2 px-4 py-2 hover:bg-[var(--gold-primary)] cursor-pointer rounded-md"
            [ngClass]="{ 'justify-center': collapsed, 'justify-start': !collapsed }">
            <i class="fas fa-cog"></i>
            <span *ngIf="!collapsed">Settings</span>
          </a>
        </li>

        <!-- Log Out -->
        <li>
          <a routerLink="/login"
            class="flex items-center gap-2 px-4 py-2 hover:bg-red-500 cursor-pointer rounded-md text-red-700 hover:text-white"
            [ngClass]="{ 'justify-center': collapsed, 'justify-start': !collapsed }">
            <i class="fas fa-sign-out-alt"></i>
            <span *ngIf="!collapsed">Log Out</span>
          </a>
        </li>

      </ul>
    </div>
  </div>
</div>
