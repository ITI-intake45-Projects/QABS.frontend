<div class="p-6 bg-[var(--background-primary)]" dir="rtl">
  <h2 class="text-xl font-bold text-[var(--green-primary)] mb-4">قائمة المدفوعات</h2>

  <!-- الجدول -->
  <div class="overflow-x-auto rounded-lg shadow-md border border-[var(--gray-medium)] relative">
    <table class="min-w-full divide-y divide-[var(--gray-medium)]">
      <thead class="bg-[var(--green-secondary)] text-white">
        <tr>
          <th class="px-4 py-3 text-right text-sm font-semibold">الصورة</th>
          <th class="px-4 py-3 text-right text-sm font-semibold">الاسم</th>
          <th class="px-4 py-3 text-right text-sm font-semibold">المبلغ المدفوع</th>
          <th class="px-4 py-3 text-right text-sm font-semibold">تاريخ الدفع</th>
          <th class="px-4 py-3 text-center text-sm font-semibold">صورة الدفع </th>
          <th class="px-4 py-3 text-center text-sm font-semibold">تفاصيل الاشتراك</th>
        </tr>
      </thead>
      <tbody class="divide-y divide-[var(--gray-light)] bg-[var(--background-secondary)]">
        <tr
          *ngFor="let student of paginatedStudents; trackBy: trackByStudentId"
          (click)="goToEnrollmentDetails(student)"
          class="hover:bg-[var(--gray-light)] transition cursor-pointer"
        >
          <!-- صورة -->
          <td class="px-4 py-3">
            <img
              [src]="student.profileImg || 'assets/images/default-profile.png'"
              alt="صورة الطالب"
              class="w-10 h-10 rounded-full border border-[var(--gray-medium)] object-cover"
            />
          </td>

          <!-- الاسم -->
          <td class="px-4 py-3 text-[var(--text-primary)] font-medium">
            {{ student.firstName }} {{ student.lastName }}
          </td>

          <!-- المبلغ المدفوع -->
          <td class="px-4 py-3 text-[var(--text-secondary)]">
            {{ student.paymentAmount }} ريال
          </td>

          <!-- العمر -->
          <td class="px-4 py-3 text-[var(--text-secondary)]">{{ student.age }}</td>

          <!-- الإجراءات -->
          <td class="px-4 py-3 text-center relative">
            <div class="flex justify-center items-center space-x-2 space-x-reverse">
              <!-- زر الحذف -->
              <button
                (click)="deletePayment(student.paymentId); $event.stopPropagation()"
                class="bg-[var(--gold-primary)] hover:bg-[var(--gold-secondary)] text-white px-3 py-1 rounded-lg text-sm"
              >
                التفاصيل
              </button>

                  <!-- زر الحذف -->
              <button
                (click)="deletePayment(student.paymentId); $event.stopPropagation()"
                class="bg-[var(--gold-primary)] hover:bg-[var(--gold-secondary)] text-white px-3 py-1 rounded-lg text-sm"
              >
                حذف
              </button>

            </div>
          </td>
        </tr>

        <!-- في حالة عدم وجود طلاب -->
        <tr *ngIf="paginatedStudents.length === 0">
          <td colspan="5" class="px-4 py-6 text-center text-[var(--text-secondary)]">
            لا يوجد طلاب حاليًا.
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- الباجينيشن -->
  <div class="flex justify-between items-center mt-4">
    <button
      (click)="prevPage()"
      [disabled]="currentPage === 1"
      class="px-4 py-2 rounded-lg bg-[var(--green-primary)] text-white hover:bg-[var(--green-dark)] disabled:opacity-50"
    >
      السابق
    </button>

    <span class="text-[var(--text-primary)] font-medium">
      صفحة {{ currentPage }} من {{ totalPages }}
    </span>

    <button
      (click)="nextPage()"
      [disabled]="currentPage === totalPages"
      class="px-4 py-2 rounded-lg bg-[var(--green-primary)] text-white hover:bg-[var(--green-dark)] disabled:opacity-50"
    >
      التالي
    </button>
  </div>
</div>


  <!-- Add Modal -->
      <div *ngIf="showAddModal" class="fixed inset-0 flex items-center justify-center bg-black/50 z-50">
        <div class="bg-white rounded-lg shadow-lg w-96 p-6 relative">
          <!-- Close Button -->
          <button (click)="closeAddModal()"
            class=" absolute top-2 right-2 text-gray-500 hover:text-red-700 cursor-pointer">
            <i class="fas fa-times"></i>
          </button>

          <h3 class="text-lg font-semibold text-[var(--green-primary)] my-4">إضافة موعد جديد</h3>

          <!-- Form -->
          <div class="space-y-4">
            <!-- اليوم -->
            <div>
              <label class="block text-sm mb-1 text-[var(--text-secondary)]">اليوم</label>
              <input  type="date" class="w-full border border-[var(--gray-medium)] rounded-lg p-2.5 text-sm text-[var(--text-primary)]
             bg-white shadow-sm
             focus:outline-none focus:ring-2 focus:ring-[var(--gold-primary)] focus:border-[var(--gold-primary)]
             transition-all duration-200">
            </div>

            <!-- وقت البدء -->
            <div>
              <label class="block text-sm mb-1 text-[var(--text-secondary)]">وقت البدء</label>
              <input  type="time" class="w-full border border-[var(--gray-medium)] rounded-lg p-2.5 text-sm text-[var(--text-primary)]
             bg-white shadow-sm
             focus:outline-none focus:ring-2 focus:ring-[var(--gold-primary)] focus:border-[var(--gold-primary)]
             transition-all duration-200">
            </div>

            <!-- وقت الانتهاء -->
            <div>
              <label class="block text-sm mb-1 text-[var(--text-secondary)]">وقت الانتهاء</label>
              <input  type="time" class="w-full border border-[var(--gray-medium)] rounded-lg p-2.5 text-sm text-[var(--text-primary)]
             bg-white shadow-sm
             focus:outline-none focus:ring-2 focus:ring-[var(--gold-primary)] focus:border-[var(--gold-primary)]
             transition-all duration-200">
            </div>
          </div>


          <!-- Actions -->
          <div class="mt-4 flex justify-end gap-2">
            <button (click)="closeAddModal()"
              class="px-3 py-1 text-sm rounded-md bg-gray-300 text-gray-700 hover:bg-gray-400 transition-colors cursor-pointer">
              إلغاء
            </button>
            <button 
              class="px-3 py-1 text-sm rounded-md bg-[var(--gold-primary)] text-white hover:bg-[var(--gold-secondary)] transition-colors cursor-pointer">
              حفظ
            </button>
          </div>
        </div>
      </div>
